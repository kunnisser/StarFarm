webpackJsonp([1],{"/fFf":function(e,a){},"1DY7":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("7+uW"),n=t("Xxa5"),i=t.n(n),r=t("exGp"),o=t.n(r),p={name:"modal",props:{title:{type:String,default:"标题"},open:{type:Boolean,default:!1}}},c={render:function(){var e=this.$createElement,a=this._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:this.open,expression:"open"}],staticClass:"modal-wrap"},[a("h3",[this._v(this._s(this.title))]),this._v(" "),this._t("modal-content")],2)},staticRenderFns:[]};var l=t("VU/8")(p,c,!1,function(e){t("Jy6Q")},null,null).exports,u=t("//Fk"),d=t.n(u),m=t("mtWM"),v=t.n(m),g={name:"loading",data:function(){return{loadvisible:!1,loadmes:""}},created:function(){var e=this;v.a.interceptors.request.use(function(a){return"get"===a.method?e.loadmes="加载数据中":e.loadmes="请求提交中..",e.loadvisible=!0,a}),v.a.interceptors.response.use(function(a){return e.loadvisible=!1,e.loadmes="",a},function(a){return e.loadmes="请求超时,刷新重新请求数据",setTimeout(function(){e.loadvisible=!1,e.loadmes=""},800),d.a.reject(a)})}},h={render:function(){var e=this.$createElement,a=this._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:this.loadvisible,expression:"loadvisible"}],staticClass:"loading-view"},[a("div",{staticClass:"loading-wrap"},[this._m(0),this._v(" "),a("div",{staticClass:"loading-mes"},[this._v("\n      "+this._s(this.loadmes)+"\n    ")])])])},staticRenderFns:[function(){var e=this.$createElement,a=this._self._c||e;return a("div",{staticClass:"loading-effect"},[a("div",{staticClass:"loadblock"},[a("div",{staticClass:"child"}),this._v(" "),a("div",{staticClass:"child"}),this._v(" "),a("div",{staticClass:"child"}),this._v(" "),a("div",{staticClass:"child"})])])}]};var f=t("VU/8")(g,h,!1,function(e){t("/fFf")},null,null).exports,_="http://www.me2u.com.cn/yzd/api",w=function(e){return function(a){return v.a.get(e,{params:a,timeout:8e3})}},b=w(_+"/login"),x=w(_+"/userInfo"),I=w(_+"/questionsNext"),k=w(_+"/answer"),C=w(_+"/rankList"),M=w(_+"/myScore"),q=w("http://www.me2u.com.cn/wxshare/share/xy"),y=w(_+"/addTimes"),N={name:"app",data:function(){return{modalVisible:!1,page:{index:-1,params:{openId:"test",name:null,phone:null,nickName:null},title:["报名信息","活动规则","奖品设置","知识竞赛","我的成绩","排行榜"],modalVisibleArr:[!1,!1,!1,!1,!1,!1],e_index:0,qa:null,qa_time:null,isAns:!1,tipVis:!1,chosedIndex:null,current_score:0,ranklist:null,scoreInfo:null,userId:window.localStorage.getItem("userId")?window.localStorage.getItem("userId"):null,joinTimes:0,intime:null,shareVisible:!1,pageInfo:{},hitNumber:0}}},created:function(){this.init(),this.page.userId||(this.modalVisible=!0,this.page.index=0,this.page.modalVisibleArr[this.page.index]=!0),this.page.userId&&this.checkUser(),this.shareInit()},computed:{manageModal:function(){return this.page.modalVisibleArr[this.page.index]&&(this.page.modalVisibleArr[this.page.index]=!0),this.page.modalVisibleArr}},methods:{init:function(){this.page.pageInfo.nickname=window.decodeURI(this.getParams("nickName")),this.page.pageInfo.headImgUrl=window.decodeURIComponent(this.getParams("headImgUrl")),this.page.pageInfo.openId=window.decodeURI(this.getParams("openId")),this.page.pageInfo.subscribe=window.decodeURI(this.getParams("subscribe")),this.page.pageInfo.ticket=window.decodeURI(this.getParams("ticket"))},checkUser:function(){var e=this;return o()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,x({userId:e.page.userId});case 3:a.sent,e.getJoinTimes(),a.next=13;break;case 7:a.prev=7,a.t0=a.catch(0),window.localStorage.removeItem("userId"),e.modalVisible=!0,e.page.index=0,e.page.modalVisibleArr[e.page.index]=!0;case 13:case"end":return a.stop()}},a,e,[[0,7]])}))()},getParams:function(e){for(var a=location.search.replace(/^\?/,"").split("&"),t={},s=0,n=a.length;s<n;s++){var i=a[s].split("=");t[i[0]]=i[1]}return e?t[e]||"":t},openModal:function(e,a){if(1===a){if(console.log(this.page.intime),this.page.intime)return void alert("不在活动时间内！");if(!this.page.joinTimes)return void this.share();this.requireQa(!0,0)}2===a&&this.rankList(),this.page.modalVisibleArr=[!1,!1,!1,!1,!1,!1],this.modalVisible=!0,this.page.index=e,this.page.modalVisibleArr[this.page.index]=!0},requireQa:function(e,a){var t=this;e||alert("请先作答！"),e&&(""===a?this.getMyscore().then(function(){t.openModal(4)}):this.getQuestion(a).then(function(){t.page.tipVis=!1,t.page.e_index++,t.page.chosedIndex=null,t.page.isAns=!1,t.page.qa&&(t.page.qa_time=(new Date).getTime())}))},subLogin:function(){var e=this;return o()(i.a.mark(function a(){var t,s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,e.page.params.openId=e.page.pageInfo.openId,e.page.params.name=e.page.params.name.toString(),e.page.params.phone=e.page.params.phone.toString(),t=/^(13[0-9]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|5|6|7|8|9]|147|177)\d{8}$/,e.page.params.nickName=e.page.pageInfo.nickname,t.test(e.page.params.phone)&&e.page.params.name.trim().length&&e.page.params.phone.trim().length){a.next=10;break}alert("注册填写错误！"),a.next=18;break;case 10:return a.next=12,b(e.page.params);case 12:(s=a.sent).data.userId&&window.localStorage.setItem("userId",s.data.userId),e.page.userId=s.data.userId,e.page.index=1,e.modalVisible=!1,e.getJoinTimes();case 18:a.next=23;break;case 20:a.prev=20,a.t0=a.catch(0),alert("网络连接错误，请重试");case 23:case"end":return a.stop()}},a,e,[[0,20]])}))()},getQuestion:function(e){var a=this;return o()(i.a.mark(function t(){var s;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I({qId:e,userId:a.page.userId});case 3:s=t.sent,a.page.qa=s.data,t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),a.page.qa=null,a.getMyscore().then(function(){a.openModal(4),alert("答题机会已用完，请分享后再试")});case 12:case"end":return t.stop()}},t,a,[[0,7]])}))()},ansQa:function(e,a){var t=this;return o()(i.a.mark(function s(){var n,r;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t.page.chosedIndex=a,e.num=t.page.e_index,e.hitNum=t.page.qa.hitNum?t.page.qa.hitNum:0,e.userId=t.page.userId,n=Math.round(((new Date).getTime()-t.page.qa_time)/1e3),e.leftTime=15-n>0?15-n:0,s.prev=6,s.next=9,k(e);case 9:r=s.sent,t.page.isAns=!0,t.page.current_score=r.data.score,t.$set(t.page.qa,"hitNum",r.data.hitNum),t.$set(t.page.qa,"rights",r.data.rights),t.page.hitNumber=1===parseInt(r.data.hitNum)?t.page.hitNumber+1:0,t.page.tipVis=!0,s.next=22;break;case 18:s.prev=18,s.t0=s.catch(6),console.log(s.t0),alert("请求失败，请重试！");case 22:case"end":return s.stop()}},s,t,[[6,18]])}))()},rankList:function(){var e=this;return o()(i.a.mark(function a(){var t,s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t={userId:e.page.userId,rows:10,time:((new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate()).toString()},a.next=4,C(t);case 4:s=a.sent,e.page.ranklist=s.data.list,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}},a,e,[[0,8]])}))()},getMyscore:function(){var e=this;return o()(i.a.mark(function a(){var t;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,M({userId:e.page.userId,_timestamp:(new Date).getTime()});case 3:t=a.sent,e.page.scoreInfo=t.data,e.page.joinTimes=t.data.num,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}},a,e,[[0,8]])}))()},getJoinTimes:function(){var e=this;return o()(i.a.mark(function a(){var t;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,M({userId:e.page.userId,_timestamp:(new Date).getTime()});case 2:t=a.sent,e.page.joinTimes=t.data.num,e.page.intime=t.data.info.length>0;case 5:case"end":return a.stop()}},a,e)}))()},share:function(){this.page.shareVisible=!0},shareInit:function(){var e=this;return o()(i.a.mark(function a(){var t;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,q({ticket:e.page.pageInfo.ticket,url:location.href.split("#")[0]});case 3:t=a.sent,wx.config({debug:!1,appId:t.data.appId,timestamp:t.data.timestamp,nonceStr:t.data.nonceStr,signature:t.data.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","hideMenuItems"]}),wx.ready(function(){wx.hideMenuItems({menuList:["menuItem:copyUrl","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:QZone","menuItem:originPage","menuItem:openWithQQBrowser","menuItem:openWithSafari","menuItem:share:email"]}),wx.error(function(e){console.log("验证失败"+e)}),wx.onMenuShareTimeline({title:"雪堰桃花节知识竞赛",link:"http://www.me2u.com.cn/weixinApi/oauth/login?code=wxc49375f2cee5ffe0&returnUrl=http://www.me2u.com.cn/starFarm/",imgUrl:"http://www.me2u.com.cn/yzdtp/resources/active/xy_qa_head.jpg",success:function(){alert("分享成功！"),e.unlocked()}})}),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),alert("初始化失败，请刷新重试！");case 11:case"end":return a.stop()}},a,e,[[0,8]])}))()},unlocked:function(){var e=this;return o()(i.a.mark(function a(){var t;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,y({userId:e.page.userId});case 3:t=a.sent,e.page.joinTimes=t.data.num,e.page.shareVisible=!1,a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),console.log(a.t0);case 11:case"end":return a.stop()}},a,e,[[0,8]])}))()},tryAgain:function(){this.page.e_index=0,this.page.hitNumber=0,this.page.joinTimes?this.openModal(3,1):this.share()}},components:{modal:l,loading:f}},V={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"app-wrap"},["0"!==e.page.pageInfo.subscribe&&e.page.pageInfo.subscribe?t("div",{staticClass:"app-box"},[t("modal",{attrs:{title:e.page.title[e.page.index],open:e.modalVisible}},[t("div",{attrs:{slot:"modal-content"},slot:"modal-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.manageModal[0],expression:"manageModal[0]"}],staticClass:"modal-box"},[t("div",{staticClass:"reg-item"},[t("label",{staticClass:"reg-name"}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.page.params.name,expression:"page.params.name"}],attrs:{type:"text",maxlength:"9",placeholder:"姓名"},domProps:{value:e.page.params.name},on:{input:function(a){a.target.composing||e.$set(e.page.params,"name",a.target.value)}}})]),e._v(" "),t("div",{staticClass:"reg-item"},[t("label",{staticClass:"reg-tel"}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.page.params.phone,expression:"page.params.phone"}],attrs:{type:"tel",maxlength:"11",placeholder:"手机号"},domProps:{value:e.page.params.phone},on:{input:function(a){a.target.composing||e.$set(e.page.params,"phone",a.target.value)}}})]),e._v(" "),t("div",{staticClass:"reg-tips"},[e._v("(领取奖品使用)")]),e._v(" "),t("button",{staticClass:"modal-btn",attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.subLogin(a)}}},[e._v("立即提交")])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.manageModal[1],expression:"manageModal[1]"}],staticClass:"modal-box rule-box"},[t("div",{staticClass:"rule-text"},[t("p",[e._v("1、微信用户关注“武进雪堰”微信公众号，填写姓名和手机号码后，方可进入答题。")]),e._v(" "),t("p",[e._v("2、每次答题共有十道题目，题目从题库中随机抽取，每题分值为10分，答题时间10秒，答对得分，答错不得分，答题用时越短所获分值越高，总分为十题分值相加，根据成绩建立排行榜，取前十名公布。")]),e._v(" "),t("p",[e._v("3、题目显示方式为逐个显示，答一题换一题，不可回看。")]),e._v(" "),t("p",[e._v("4、活动分为三期，时间为2018年3月21日—23日，每天的13:30-20:30。每个微信号参与一次，分享至朋友圈，可多参与一次，同一微信号取成绩最好一次记录。")]),e._v(" "),t("p",[e._v("5、每期排行榜前十名可获价值150元左右雪堰农副产品，三期获奖人员共计30人，每期获奖名单将在次日上午武进雪堰微信公众号公布。每个微信号只获奖一次。")]),e._v(" "),t("p",[e._v("6、领奖方式：2018年3月26日至30日，到雪堰镇便民服务中心（潘北街1号）领取。时间：上午8:00至11:00，下午1:00至4:30,凭获奖者手机号码领取。")])]),e._v(" "),t("div",{staticClass:"modal-btn-gp"},[t("button",{staticClass:"rule-left-btn",attrs:{type:"button"},on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(2)}}},[e._v("奖品设置")]),e._v(" "),t("button",{staticClass:"rule-right-btn",attrs:{type:"button"},on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(3,1)}}},[e._v("开始答题")])])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.manageModal[2],expression:"manageModal[2]"}],staticClass:"modal-box prize-box"},[t("div",{staticClass:"prize-item"},[t("h4",[e._v("每期排行榜前十名")]),e._v(" "),t("p",[t("span",[e._v("可获价值150元左右的雪堰农副产品")])])]),e._v(" "),t("div",{staticClass:"modal-btn-gp"},[t("button",{staticClass:"rule-left-btn",attrs:{type:"button"},on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(1)}}},[e._v("活动规则")]),e._v(" "),t("button",{staticClass:"rule-right-btn",attrs:{type:"button"},on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(3,1)}}},[e._v("开始答题")])])]),e._v(" "),e.page.qa?t("div",{directives:[{name:"show",rawName:"v-show",value:e.manageModal[3],expression:"manageModal[3]"}],staticClass:"modal-box exam-box"},[t("div",{staticClass:"exam-header"},[t("span",[e._v("得分："+e._s(e.page.current_score)+" 分")]),e._v(" "),t("div",{staticClass:"exam-progress"},[e._v("已答 "),t("span",[e._v(e._s(e.page.e_index)+" / 10")])])]),e._v(" "),t("div",{staticClass:"exam-question"},[e._v("\n              "+e._s(e.page.qa.name)+"\n            ")]),e._v(" "),t("div",{staticClass:"exam-content fail"},e._l(e.page.qa.answers,function(a,s){return t("div",{class:"exam-item "+(e.page.qa.rights===a.aId.toString()?"right":e.page.chosedIndex==s.toString()?"error":""),on:{click:function(t){t.preventDefault(),t.stopPropagation(),e.page.isAns||e.ansQa({aId:a.aId,qId:e.page.qa.qId},s)}}},[e._v(e._s(s+1)+". "+e._s(a.name))])})),e._v(" "),t("button",{staticClass:"modal-btn",attrs:{type:"button"},on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.requireQa(e.page.isAns,e.page.qa.next_qId)}}},[e._v(e._s(!e.page.qa.next_qId&&e.page.isAns?"查看成绩":"下一题"))]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:parseInt(e.page.hitNumber)>0&&e.page.tipVis,expression:"parseInt(page.hitNumber) > 0 && page.tipVis"}],staticClass:"exam-tip"},[e._v(e._s(e.page.hitNumber)+"连击!")])]):e._e(),e._v(" "),e.page.scoreInfo?t("div",{directives:[{name:"show",rawName:"v-show",value:e.manageModal[4],expression:"manageModal[4]"}],staticClass:"modal-box score-box"},[t("div",{staticClass:"score-item"},[t("span",[e._v("本轮答题得分: ")]),t("span",[e._v(e._s(e.page.current_score)+" 分")])]),e._v(" "),t("div",{staticClass:"score-item"},[t("span",[e._v("历史最高得分: ")]),t("span",[e._v(e._s(e.page.scoreInfo.todayScore)+" 分")])]),e._v(" "),t("div",{staticClass:"score-item"},[t("span",[e._v("当前答题排名: ")]),t("span",[e._v(e._s(e.page.scoreInfo.myRank)+" 名")])]),e._v(" "),t("div",{staticClass:"score-item"},[t("span",[e._v("距上一名还差: ")]),t("span",[e._v(e._s(e.page.scoreInfo.nextScore.nextScore?e.page.scoreInfo.nextScore.nextScore:0)+" 分")])]),e._v(" "),t("button",{staticClass:"modal-btn",attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.tryAgain(a)}}},[e._v("再答一次")])]):e._e(),e._v(" "),e.page.ranklist?t("div",{directives:[{name:"show",rawName:"v-show",value:e.manageModal[5],expression:"manageModal[5]"}],staticClass:"modal-box rank-box"},[e._l(e.page.ranklist,function(a){return t("div",{staticClass:"rank-item"},[t("span",[e._v("第 "+e._s(a.rank)+" 名")]),e._v(" "),t("span",[e._v(e._s(a.nickName))]),e._v(" "),t("span",[e._v(e._s(a.scores)+" 分")])])}),e._v(" "),t("button",{staticClass:"modal-btn",attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.tryAgain(a)}}},[e._v("再答一次")])],2):e._e()])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.modalVisible,expression:"!modalVisible"}],staticClass:"app-btnGp"},[t("div",{staticClass:"begin-btn",on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(3,1)}}}),e._v(" "),t("div",{staticClass:"app-footbar"},[t("div",{staticClass:"rule-btn",on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(1)}}}),e._v(" "),t("div",{staticClass:"prize-btn",on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(2)}}})])]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.modalVisible,expression:"modalVisible"}],staticClass:"app-btnTop"},[e.page.scoreInfo?t("div",{staticClass:"nick-box"},[t("img",{attrs:{src:e.page.pageInfo.headImgUrl}}),e._v(" "),t("p",[e._v(e._s(e.page.pageInfo.nickname.substr(0,4))+"..")])]):e._e(),e._v(" "),e.page.scoreInfo?t("div",{staticClass:"rank-wrapbox",on:{click:function(a){a.preventDefault(),a.stopPropagation(),e.openModal(5,2)}}},[t("div",{staticClass:"rank-icon"}),e._v(" "),t("p",[e._v("排行榜")])]):e._e()])],1):t("div",{staticClass:"share-tip"},[e._m(0)]),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.page.shareVisible,expression:"page.shareVisible"}],staticClass:"share-tip"},[t("div",{staticClass:"share-banner"})]),e._v(" "),t("loading")],1)},staticRenderFns:[function(){var e=this.$createElement,a=this._self._c||e;return a("div",{staticClass:"code"},[a("div",{staticClass:"code-box"},[a("div",{staticClass:"code-tip"},[a("p",[this._v("请长按下图选择[识别图中二维码]")]),this._v(" "),a("p",[this._v("关注并进入公众号后，找到底部菜单")]),this._v(" "),a("p",[this._v("参与活动")])]),this._v(" "),a("div",{staticClass:"code-icon"},[a("img",{attrs:{src:"http://mmbiz.qpic.cn/mmbiz_jpg/SR7QeqmaJLw0ysgiaPTsDKhQRgOQo4LQgx1oMn5GKpqqean5jTWvy58wecwIOsgNoHVjPaJ51IyBejB1gQPeXuA/0"}})])])])}]};var P,S,A=t("VU/8")(N,V,!1,function(e){t("2tTJ")},null,null).exports,D=t("GtN+"),T=document.documentElement,Q=T.querySelector('meta[name = "viewport"]'),U=void 0,j=T.clientWidth;U=window.devicePixelRatio||1,D.a.desktop()&&j>=750&&(j=750),1.5===U&&(U=1),S=1/U,P=j*U/10,T.setAttribute("data-dpr",U),Q.setAttribute("content","initial-scale = "+S+",maximum-scale="+S+",minimum-scale="+S+",user-scalable = no");var R=D.a.desktop()?75/U:j*U/10;T.style.fontSize=R+"px",window.onresize=function(){var e=D.a.desktop()?75/U:document.documentElement.clientWidth/10;T.style.fontSize=e+"px"},window.rem2px=function(e){return(e=parseFloat(e))*P},window.px2rem=function(e){return(e=parseFloat(e))/P},new s.a({el:"#app",render:function(e){return e(A)}})},"2tTJ":function(e,a){},Jy6Q:function(e,a){}},["1DY7"]);
//# sourceMappingURL=app.7b4c70b5880be1b5c824.js.map
